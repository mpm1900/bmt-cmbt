import{R as b}from"./index-CvTy_Tuv.js";const f=[];for(let e=0;e<256;++e)f.push((e+256).toString(16).slice(1));function de(e,t=0){return(f[e[t+0]]+f[e[t+1]]+f[e[t+2]]+f[e[t+3]]+"-"+f[e[t+4]]+f[e[t+5]]+"-"+f[e[t+6]]+f[e[t+7]]+"-"+f[e[t+8]]+f[e[t+9]]+"-"+f[e[t+10]]+f[e[t+11]]+f[e[t+12]]+f[e[t+13]]+f[e[t+14]]+f[e[t+15]]).toLowerCase()}let R;const ge=new Uint8Array(16);function me(){if(!R){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");R=crypto.getRandomValues.bind(crypto)}return R(ge)}const De=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),L={randomUUID:De};function Ie(e,t,n){e=e||{};const r=e.random??e.rng?.()??me();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,de(r)}function u(e,t,n){return L.randomUUID&&!e?L.randomUUID():Ie(e)}function _(e){const t=Math.random()*100;return[t<=e,t]}function Q(e,t){return{...e,state:{...e.state,...t}}}function Y(e,t){return{...e,stats:{...e.stats,...t}}}function x(e){return{type:"power",success:!1,evade:!1,critical:!1,criticalModifier:1,element:"physical",...e}}function J(e){return{success:!1,successRoll:0,successThreshold:0,critical:!1,criticalRoll:0,criticalThreshold:0,...e}}function P(e,t,n){return{...e,success:t.success,evade:n.success,critical:t.success&&t.critical}}function O(e,t,n){const r=e+n.stats.accuracy,o=_(r),i=t+0,c=_(i);return J({success:o[0],successRoll:o[1],successThreshold:r,critical:c[0],criticalRoll:c[1],criticalThreshold:i})}function U(e){const t=_(e.stats.evasion);return J({success:t[0],successRoll:t[1],successThreshold:e.stats.evasion})}function ye(e,t,n){if(n.type==="raw")return n.raw;if(n.type==="power"){const r=e.stats[n.offenseStat],o=t.stats[n.defenseStat],i=r/o,c=n.success?1:0,s=n.critical?n.criticalModifier:1,a=n.evade?0:1;return Math.round(n.power*i*c*s*a)}return 0}function ve(e,t,n){return Q(e,{damage:t,alive:n})}function he(e,t){if(e.modified)return console.error("already modified",e,t),[e,[]];const n=new Set;return e=t.flatMap(o=>{const{effect:i,context:c}=o;return i.modifiers(c).map(a=>({ID:u(),effect:i,modifier:a,context:c}))}).sort((o,i)=>o.effect.priority-i.effect.priority).reduce((o,i)=>{const{modifier:c,context:s,effect:a}=i;return c.filter&&!c.filter(o,s)?o:(n.add(a.ID),c.apply(o,s))},{...e}),e.modified=!0,[e,Array.from(n)]}function be(e){const{accuracy:t,body:n,evasion:r,health:o,intelligence:i,reflexes:c,...s}=e.stats,a=c,l=0,p=n;return{...s,accuracy:t+a,body:n,evasion:r+l,health:o+p,intelligence:i,reflexes:c}}const H={ID:u(),delay:0,duration:void 0,priority:0,modifiers:()=>[{ID:u(),filter:(e,t)=>e.ID===t.sourceID,apply:e=>Y(e,{body:e.stats.body+10})}],triggers:()=>[]};function X(e,t){return e.players.find(o=>o.ID===t.playerID)?.activeActorIDs[t.index]??void 0}function _e(e,t){const n=e.actors.find(i=>i.ID===t),r=e.players.find(i=>i.ID===n?.playerID),o=r?.activeActorIDs.indexOf(t);return r?.ID&&o!==void 0&&o!==-1?{ID:u(),playerID:r.ID,index:o}:void 0}function xt(e,t){return e?.playerID===t?.playerID&&e?.index===t?.index}function Ae(e){return[...e.effects,...e.combat?.effects??[]].flatMap(({effect:n,context:r})=>n.triggers(r))}function w(e,t){return e.actors.find(n=>n.ID===t)}function Se(e,t){const[n,r]=he(e,t);return[{...n,stats:be(n)},r]}function d(e,t){const n=w(e,t);if(!n)return;const r=[...e.effects,...e.combat?.effects??[]];return Se(n,r)[0]}function I(e,t,n){const r=d(e,t);if(r)return n(r)}function Qe(e,t,n){const r=X(e,t);return r?I(e,r,n):void 0}function h(e,t){return{ID:u(),type:t,target:e}}function D(e,t){return e.players.some(n=>n.activeActorIDs.includes(t))}function xe(e,t,n){return e&&e.validate(t,n)}function we(e,t){return e?.actions.find(n=>xe(n,t,g({sourceID:e.ID})))}function Ce(e,t){const n=t.positions.map(r=>X(e,r));return{playerID:t.playerID,sourceID:t.sourceID,targetIDs:n.filter(r=>r!==void 0).concat(t.targetIDs)}}function Me(e,t){return[...e,...t]}function A(e,t){return[...t,...e]}function C(e){const[t,...n]=e;return n}function Te(e,t){return e.sort(t)}const $={ID:u(),name:"Activate Actor",validate:()=>!0,targets:{unique:!0,max:()=>1,get:(e,t)=>e.actors.filter(n=>!D(e,n.ID)&&n.playerID===t.playerID&&n.state.alive).map(n=>h(n,"targetID")),validate:(e,t)=>t.targetIDs.length===1},ai:{compute:(e,t)=>I(e,t.targetIDs[0],n=>1e3-n.state.damage)??0,generateContexts:(e,t,n)=>n.targets.get(e,t).map(o=>({...t,targetIDs:[o.target.ID]}))},resolve:(e,t)=>[ie(t.playerID,t.sourceID,t),t.targetIDs.map(n=>We(t.playerID,n,t))]};function Re(e){return{...$,targets:{...$.targets,max:()=>e,validate:(t,n)=>n.targetIDs.length===e}}}function Ee(e,t,n){return e.validate(t,n)?e.resolve(t,n).flatMap(r=>r):(console.error("resolver validation failed",e,t,n),[])}function Pe(e){e=Fe(e);const t=e.actionQueue[0];e=y(e,[`${I(e,t.context.sourceID,i=>i.name)} uses ${t.action.name}.`]);const n=oe(e,t.context,t.action),r=A(e.mutationQueue,n),o=C(e.actionQueue);return{...e,actionQueue:o,mutationQueue:r}}function Oe(e){if(!e.triggerQueue[0])return e;const t=Ee(e.triggerQueue[0].trigger,e,e.triggerQueue[0].context),n=C(e.triggerQueue),r=A(e.mutationQueue,t);return{...e,mutationQueue:r,triggerQueue:n}}function Ue(e){if(!e.mutationQueue[0])return e;const{delta:t,context:n}=e.mutationQueue[0];if(t.filter&&!t.filter(e,n))return e;e=e.mutationQueue[0].delta.apply(e,e.mutationQueue[0].context);const r=C(e.mutationQueue);return{...e,mutationQueue:r}}function je(e){switch(e){case"pre":return"start";case"start":return"planning";case"planning":return"main";case"main":return"end";case"end":return"start";default:return"pre"}}function j(e){if(!e.combat)return e;const t=je(e.combat.phase);if(e=re(e,t),t==="start"&&(e=v(e,g({}),"onTurnStart")),t==="planning"){const n=e.players.find(r=>r.ID==="__ai__");n.activeActorIDs.forEach(r=>{if(!r)return;const o=w(e,r)?.actions.filter(s=>s.ai)??[],i=g({playerID:n.ID,sourceID:r}),c=o.map(s=>{const a=s.ai.generateContexts(e,i,s).map(l=>[l,s.ai.compute(e,l)]).sort((l,p)=>p[1]-l[1]);return[s,a[0][0],a[0][1]]});console.log(c),c[0]&&(e=ee(e,c[0][1],c[0][0]))})}return t==="end"&&(e=v(e,g({}),"onTurnEnd")),e}function Ne(e){if(!e.promptQueue[0])return e;const{action:t,context:n}=e.promptQueue[0];if(n.playerID!=="__ai__"||!t.ai)return e;const r=t.ai.generateContexts(e,n,t).map(o=>[o,t.ai.compute(e,o)]).sort((o,i)=>i[1]-o[1]);return e=te(e,r[0][0]),e}function E(e){if(e.triggerQueue.length>0)return Oe(e);if(e.mutationQueue.length>0)return Ue(e);if(e.promptQueue.length>0)return Ne(e);const t=ze(e);return e=t[0],t[1]?e.actionQueue.length>0?Pe(e):e.combat?j(e):e:e}function Z(e){return e.mutationQueue.length>0||e.triggerQueue.length>0||e.actionQueue.length>0&&e.promptQueue.length===0}function wt(e){return e.combat?.phase==="planning"?"pending":Z(e)?"running":e.promptQueue.length>0?"pending":"idle"}function Le(e){for(;Z(e);)e=E(e);return e}function g(e){return{playerID:"",sourceID:"",targetIDs:[],positions:[],...e}}function He(e){return{...e,duration:e.duration===void 0?void 0:e.duration-1}}function $e(e){return{...e,effect:He(e.effect)}}function y(e,t){return{...e,combatLog:[...e.combatLog,...t]}}function ee(e,t,n){const r=A(e.actionQueue,[{ID:u(),action:n,context:t}]);return{...e,actionQueue:r}}function ke(e,t,n){if(e.actionQueue.find(i=>i.context.sourceID===t.sourceID))return e;e=ee(e,t,n);const o=e.players.reduce((i,c)=>i+c.activeActorIDs.filter(Boolean).length,0);return e.actionQueue.length===o&&(e=j(e)),e}function qe(e,t,n){const r=A(e.promptQueue,[{ID:u(),action:n,context:t}]);return{...e,promptQueue:r}}function te(e,t){if(!e.promptQueue[0])return e;const n=oe(e,t,e.promptQueue[0].action),r=A(e.mutationQueue,n),o=C(e.promptQueue);return{...e,promptQueue:o,mutationQueue:r}}function v(e,t,n){const o=Ae(e).filter(c=>c.type===n&&c.validate(e,t)).map(c=>({ID:u(),trigger:c,context:t})),i=Me(e.triggerQueue,o);return{...e,triggerQueue:i}}function Fe(e){const t=Te(e.actionQueue,(n,r)=>{const o=I(e,n.context.sourceID,c=>c.stats.speed)??0;return(I(e,r.context.sourceID,c=>c.stats.speed)??0)-o});return{...e,actionQueue:t}}function Ve(e,t){const n=e.actionQueue.filter(r=>r.context.sourceID!==t);return console.log("filtering action queue",t),console.log(e.actionQueue),console.log(n),{...e,actionQueue:n}}function N(e,t,n){return{...e,actors:e.actors.map(r=>!r.state.alive||n.filter&&!n.filter(r,t)?r:n.apply(r,t))}}function ne(e,t,n){return{...e,players:e.players.map(r=>n.filter&&!n.filter(r,t)?r:n.apply(r,t))}}function Ge(e,t,n){let r=0;e=N(e,t,{filter:s=>t.targetIDs.includes(s.ID),apply:s=>{const a=d(e,t.sourceID),l=d(e,s.ID);if(!a||!l)return s;const p=ye(a,l,n);r+=p;const m=s.state.damage+p;return ve(s,m,m<a.stats.health?1:0)}});const o=t.targetIDs[0],i=w(e,o),c=D(e,o)&&!i?.state.alive;return r>0&&(e=v(e,t,"onDamage"),e=y(e,[`${i?.name} took ${r} damage.`])),c&&(e=v(e,t,"onDeath")),e}function re(e,t){return e.combat?{...e,combat:{...e.combat,phase:t}}:e}function ze(e){let t=!0;return e.players.forEach(n=>{const r=e.actors.filter(o=>o.playerID===n.ID&&!n.activeActorIDs.includes(o.ID)&&o.state.alive);if(n.activeActorIDs.some(o=>o===null)&&r.length>0){const o=Math.min(r.length,n.activeActorIDs.filter(i=>i===null).length);e=qe(e,g({playerID:n.ID}),Re(o)),t=!1}n.activeActorIDs.every(o=>o===null)&&r.length===0&&(e=re(e,"post"),t=!1)}),[e,t]}function oe(e,t,n){if(!n.validate(e,t)){console.error("resolver validation failed",n,e,t);const o=n;return o.name?[M(t,()=>`${o.name} failed.`)]:[]}const r=Ce(e,t);return n.resolve(e,r).flatMap(o=>o)}function Ke(e,t){const n={apply:(r,o)=>N(r,o,{filter:i=>i.ID===o.sourceID,apply:i=>Q(i,t(i.state))})};return{ID:u(),delta:n,context:e}}function M(e,t){const n={apply:(r,o)=>y(r,[t(r,o)])};return{ID:u(),delta:n,context:e}}function Be(e,t,n){return{ID:u(),context:t,delta:{apply:r=>N(r,t,{filter:o=>o.ID===e,apply:n})}}}function We(e,t,n){return{ID:u(),context:n,delta:{apply:r=>{const o=r.players.find(s=>s.ID===e),i=o.activeActorIDs.indexOf(null),c=o.activeActorIDs.indexOf(t);return i===-1?(console.error("NO SPACE"),r):c!==-1?(console.error("ALREADY ACTIVE"),r):(r=ne(r,n,{filter:s=>s.ID===e,apply:s=>({...s,activeActorIDs:s.activeActorIDs.map((a,l)=>l===i?t:a)})}),r=y(r,[`${w(r,t)?.name} joined the battle.`]),r=v(r,n,"onActorActivate"),r)}}}}function ie(e,t,n){return{ID:u(),context:n,delta:{apply:r=>{const i=r.players.find(c=>c.ID===e).activeActorIDs.indexOf(t);return i===-1?(t&&console.error("ACTOR NOT FOUND",t,e,n),r):(r=ne(r,n,{filter:c=>c.ID===e,apply:c=>({...c,activeActorIDs:c.activeActorIDs.map((s,a)=>a===i?null:s)})}),r=Ve(r,t),r=v(r,n,"onActorDeactivate"),r)}}}}function Ye(){return{ID:u(),context:g({}),delta:{apply:(e,t)=>({...e,effects:e.effects.map(n=>$e(n)).filter(n=>n.effect.duration!==0)})}}}function ce(e,t){return{ID:u(),context:t,delta:{apply:(n,r)=>({...n,effects:[...n.effects,{ID:u(),effect:e,context:r}]})}}}function T(e,t,n){return{ID:u(),context:e,delta:{apply:(r,o)=>(r=t.reduce((i,c,s)=>{const a=n[s]??o,l=d(i,a.sourceID);if(c.type==="power"&&l){if(!c.success)i=y(i,[`${l.name}'s attack missed.`]);else if(c.evade){const p=d(i,a.targetIDs[0]);i=y(i,[`${p?.name} evaded the attack.`])}}return i=Ge(i,a,c),i},r),r)}}}function Je(e){return{ID:u(),context:e,delta:{apply:(t,n)=>t.combat?{...t,combat:{...t.combat,turn:t.combat.turn+1}}:t}}}const Xe={ID:u(),delay:0,duration:1,priority:0,modifiers:H.modifiers,triggers:e=>[{ID:u(),type:"onDamage",validate:(t,n)=>n.targetIDs.includes(e.sourceID),resolve:(t,n)=>[ce(H,e)]}]},Ze={ID:u(),delay:0,duration:void 0,priority:0,modifiers:()=>[],triggers:()=>[{ID:u(),type:"onDeath",validate:()=>!0,resolve:(e,t)=>t.targetIDs.flatMap(n=>{const r=e.actors.find(o=>o.ID===n);return[M(t,()=>`${r.name} died.`),ie(r.playerID,n,t)]})}]},et={ID:u(),delay:0,duration:void 0,priority:0,modifiers:()=>[],triggers:()=>[{ID:u(),type:"onTurnStart",validate:()=>!0,resolve:(e,t)=>[Je(t),M(t,n=>`Turn ${n.combat?.turn} started`)]}]},tt={ID:u(),delay:0,duration:void 0,priority:0,modifiers:()=>[],triggers:()=>[{ID:u(),type:"onTurnEnd",validate:()=>!0,resolve:(e,t)=>[Ye(),M(t,n=>`Turn ${n.combat?.turn} ended`)]}]},Ct=["pre","start","planning","main","end","post"];function nt(){return{turn:0,phase:"pre",effects:[{ID:u(),effect:Ze,context:g({})},{ID:u(),effect:et,context:g({})},{ID:u(),effect:tt,context:g({})}]}}const k=e=>{let t;const n=new Set,r=(l,p)=>{const m=typeof l=="function"?l(t):l;if(!Object.is(m,t)){const fe=t;t=p??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(pe=>pe(t,fe))}},o=()=>t,s={setState:r,getState:o,getInitialState:()=>a,subscribe:l=>(n.add(l),()=>n.delete(l))},a=t=e(r,o,s);return s},ue=(e=>e?k(e):k),rt=e=>e;function se(e,t=rt){const n=b.useSyncExternalStore(e.subscribe,b.useCallback(()=>t(e.getState()),[e,t]),b.useCallback(()=>t(e.getInitialState()),[e,t]));return b.useDebugValue(n),n}const q=e=>Symbol.iterator in e,F=e=>"entries"in e,V=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[o,i]of n)if(!r.has(o)||!Object.is(i,r.get(o)))return!1;return!0},ot=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let o=n.next(),i=r.next();for(;!o.done&&!i.done;){if(!Object.is(o.value,i.value))return!1;o=n.next(),i=r.next()}return!!o.done&&!!i.done};function it(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null||Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?!1:q(e)&&q(t)?F(e)&&F(t)?V(e,t):ot(e,t):V({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})}function ae(e){const t=b.useRef(void 0);return n=>{const r=e(n);return it(t.current,r)?t.current:t.current=r}}const ct=x({offenseStat:"intelligence",defenseStat:"intelligence",element:"psy",power:30,criticalModifier:1.5}),ut={ID:u(),name:"Brain Blast",validate:()=>!0,targets:{unique:!0,max:()=>2,get:(e,t)=>e.actors.filter(n=>n.ID!==t.sourceID&&D(e,n.ID)).map(n=>h(n,"position")),validate:(e,t)=>0<t.positions.length&&t.positions.length<=2},resolve:(e,t)=>[t.targetIDs.map(n=>{const r=O(100,0,d(e,t.sourceID)),o=U(d(e,n)),i=P(ct,r,o),c={...t,targetIDs:[n]};return T(c,[i],[c])})]},st={ID:u(),name:"Dragon Dance",validate:()=>!0,targets:{unique:!0,max:()=>0,get:()=>[],validate:()=>!0},resolve:(e,t)=>[ce({ID:u(),delay:0,duration:void 0,priority:0,triggers:()=>[],modifiers:()=>[{ID:u(),filter:(n,r)=>n.ID===r.sourceID,apply:n=>Y(n,{body:n.stats.body*1.5})}]},{playerID:t.playerID,sourceID:t.sourceID,targetIDs:[t.sourceID]})]},G=2,z=50,at=x({offenseStat:"intelligence",defenseStat:"intelligence",element:"fire",power:50,criticalModifier:1.5}),lt={ID:u(),name:"Fireball",validate:(e,t)=>!!I(e,t.sourceID,n=>n.state.mana>=z),targets:{unique:!0,get:(e,t)=>e.actors.filter(n=>n.ID!==t.sourceID&&D(e,n.ID)).map(n=>h(n,"position")),max:()=>G,validate:(e,t)=>0<t.positions.length&&t.positions.length<=G},ai:{generateContexts:(e,t,n)=>n.targets.get(e,t).map(r=>{const o=_e(e,r.target.ID);return{...t,sourceID:t.sourceID,positions:o?[o]:[]}}),compute:(e,t)=>Qe(e,t.positions[0],n=>n.stats.health-n.state.damage)??0},resolve:(e,t)=>{const n=d(e,t.sourceID),r=O(100,0,n);return[Ke(t,o=>({mana:o.mana-z})),T(t,t.targetIDs.map(o=>{const i=d(e,o),c=U(i);return P(at,r,c)}),t.targetIDs.map(o=>({...t,targetIDs:[o]})))]}},ft={ID:u(),name:"Heal",validate:()=>!0,targets:{unique:!0,max:()=>1,get:(e,t)=>e.actors.map(n=>h(n,"position")),validate:(e,t)=>t.positions.length===1},resolve(e,t){return[Be(t.targetIDs[0],t,n=>Q(n,{damage:Math.max(n.state.damage-20,0)}))]}},pt={ID:u(),name:"Hot Shots",validate:()=>!0,targets:{unique:!1,max:()=>1,get:(e,t)=>e.actors.filter(n=>n.ID!==t.sourceID&&D(e,n.ID)).map(n=>h(n,"position")),validate:(e,t)=>t.positions.length===1},resolve:(e,t)=>{const n=[];let r=_(80);const o=[r[1]];for(;r[0];)n.push(T(t,[x({offenseStat:"reflexes",defenseStat:"reflexes",element:"fire",power:20})],[t])),r=_(80),o.push(r[1]);return n}},dt=x({offenseStat:"reflexes",defenseStat:"reflexes",element:"physical",power:8,criticalModifier:1.5}),gt=50,K=8,mt={ID:u(),name:"Magic Missile",validate:()=>!0,targets:{unique:!1,max:()=>K,get:(e,t)=>e.actors.filter(n=>n.ID!==t.sourceID&&D(e,n.ID)).map(n=>h(n,"position")),validate:(e,t)=>t.positions.filter(n=>!!n).length===K},resolve:(e,t)=>[t.targetIDs.map(n=>{const r=O(gt,0,d(e,t.sourceID)),o=U(d(e,n)),i=P(dt,r,o),c={...t,targetIDs:[n]};return T(c,[i],[c])})]},Dt=[lt,mt,ut,ft,st,pt];function S(e,t,n){return{ID:u(),playerID:t,parentID:void 0,name:e,modified:!1,actions:Dt,stats:n,state:{mana:100,damage:0,alive:1}}}const B=S("Max","__player__",{accuracy:0,body:100,evasion:0,health:0,reflexes:100,intelligence:100,speed:100}),It=S("Katie","__player__",{accuracy:0,body:100,evasion:0,health:0,reflexes:100,intelligence:180,speed:70}),yt=S("Hank","__player__",{accuracy:0,body:180,evasion:100,health:0,intelligence:100,reflexes:150,speed:150}),vt=S("Milo","__player__",{accuracy:0,body:100,evasion:0,health:0,intelligence:100,reflexes:100,speed:100}),le=S("Criminal","__ai__",{accuracy:0,body:100,evasion:0,health:0,intelligence:100,reflexes:100,speed:100}),W={ID:"__player__",activeActorIDs:[null,null,null]},ht={ID:"__ai__",activeActorIDs:[null,null,null]},bt={players:[ht,W],combat:void 0,actors:[B,It,yt,vt,le],effects:[{ID:u(),effect:Xe,context:g({playerID:W.ID,sourceID:B.ID})}],actionQueue:[],promptQueue:[],triggerQueue:[],mutationQueue:[],combatLog:["Combat started"]},_t=ue(e=>({state:bt,pushAction:(t,n)=>{e(({state:r})=>({state:ke(r,n,t)}))},resolvePrompt:t=>{e(({state:n})=>(n=te(n,t),{state:n}))},next:()=>{e(({state:t})=>({state:E(t)}))},flush:()=>{e(({state:t})=>({state:Le(t)}))},nextPhase:()=>{e(({state:t})=>({state:{...j(t),promptQueue:[]}}))},createCombat:()=>{e(({state:t})=>({state:E({...t,combat:nt(),actors:t.actors.map(n=>n.ID===le.ID?Q(n,{damage:0,alive:1}):n)})}))},deleteCombat:()=>{e(({state:t})=>({state:{...t,combat:void 0}}))}}));function At(e){return se(_t,ae(e))}function Mt(){return At(e=>e.state.combat?.phase)}const St=ue((e,t)=>({playerID:"__player__",view:"dialog",activeActorID:void 0,activeActionID:void 0,stagingContext:void 0,set:n=>e(n),resetActive:n=>{const o=t().playerID,i=n.actors.find(c=>c&&c.playerID===o&&D(n,c.ID)&&!n.actionQueue.find(s=>s.context.sourceID===c.ID));i&&e({activeActorID:i.ID,activeActionID:we(i,n)?.ID,stagingContext:void 0})}}));function Tt(e){return se(St,ae(e))}export{Ct as C,lt as F,$ as S,Tt as a,d as b,at as c,G as d,mt as e,K as f,_e as g,gt as h,dt as i,Mt as j,Se as k,wt as l,we as n,xt as p,At as u,he as w};
